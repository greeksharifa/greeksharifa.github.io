<!DOCTYPE html>
<html lang="en-us">
<head>
  <head>
  <!-- Description of Blog -->
  <meta name="description" content="Python, Machine & Deep Learning">
  <link rel="canonical" href="https://greeksharifa.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Python, Machine & Deep Learning">
  <meta property="og:description" content="Python, Machine Learning & Deep Learning 설명서">
  <meta property="og:image" content="https://greeksharifa.github.io/public/img/icon-144x144.png">
  <meta property="og:url" content="https://greeksharifa.github.io/">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Python, Machine & Deep Learning">
  <meta name="twitter:description" content="Python, Machine Learning & Deep Learning 설명서">
  <meta name="twitter:image" content="https://greeksharifa.github.io/public/img/icon-144x144.png">
  <meta name="twitter:domain" content="https://greeksharifa.github.io/">

  <!-- link -->
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  
  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      파이썬 정규표현식(re) 사용법 - 05. 주석, 치환, 분리
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/main.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="icon-144x144" sizes="144x144" href="/public/img/icon-144x144.png">
  <link rel="shortcut icon" href="/public/img/icon_32x32.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  
  <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_SVG"> </script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true } });
  </script>
  

  <!-- Ads -->
  <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
  </script>
</head>

  <!-- for Google AdSense-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-9951774327887666",
    enable_page_level_ads: true
  });
</script>

  <style>blockquote {
    font-size: 1em;
    line-height: 1.4
  }</style>
  <link href='http://fonts.googleapis.com/css?family=Gill+Sans' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Consolas' rel='stylesheet' type='text/css'>
</head>
<body>

<!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <div class="sidebar-personal-info">
      <div class="sidebar-personal-info-section">
        <a href="http://gravatar.com/3c2986ad7ac1f2230ea3596f44563328">
          <img src="/public/img/maple_tree.jpg" title="Cover Photo" alt="Maple tree" />
        </a>
      </div>
      <div class="sidebar-personal-info-section">
        <p><strong>Developer and Analyst</strong>, YW & YY.</p>
      </div>
      
      
      
      <div class="sidebar-personal-info-section">
        <p> Follow me:
        
        
        
        <a href="https://github.com/greeksharifa">
          <i class="fa fa-github" aria-hidden="true"></i>
        </a>
        
        |
        
        
        
        <a href="mailto:greeksharifa@gmail.com">
          <i class="fa fa-envelope" aria-hidden="true"></i>
        </a>
        
        
        
        </p>
      </div>
      
    </div>
  </div>

  <nav class="sidebar-nav">
    
      
      
      

      

      <span class="">
        <a class="sidebar-nav-item " href="/">
          Home
        </a>

        
      </span>

    
      
      
      

      

      <span class="foldable">
        <a class="sidebar-nav-item " href="/blog/">
          Blog
        </a>

        
          
            
            
            
              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/categories/">
                Categories
              </a>
          
        
          
            
            
            
              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/tags/">
                Tags
              </a>
          
        
      </span>

    
      
      
      

      

      <span class="">
        <a class="sidebar-nav-item " href="/about/">
          About
        </a>

        
      </span>

    
      
      
      

      

      <span class="">
        <a class="sidebar-nav-item " href="http://greeksharifa.github.io/">
          Github Project
        </a>

        
      </span>

    

  </nav>

  <div class="sidebar-item">
    <p>
    &copy; 2020 YW & YY. This work is liscensed under <a href="http://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a>.
    </p>
  </div>

  <div class="sidebar-item">
    <p>
    Powered by <a href="http://jekyllrb.com">jekyll</a> and <a href="http://greeksharifa.github.io">YW & YY</a>
    </p>
  </div>
</div>


<!-- Wrap is the content to shift when toggling the sidebar. We wrap the
     content to avoid any CSS collisions with our real content. -->
<div class="wrap">
  <div class="masthead">
    <div class="container">
      <h3 class="masthead-title" align="center">
        <a href="/" title="Home" title="YW & YY">
          <img class="masthead-logo" src="/public/img/logo.png"/>
        </a>
        <small>YW & YY's Python, Machine & Deep Learning</small>
        <!-- HTML elements for search -->
        <a href="/search/" id="search_icon">
          <img src="/public/img/search.png" width="25" height="25"
               align="right" style="margin-top:5px; margin-bottom:0;"
               onmouseover="this.style.opacity=0.7" onmouseout="this.style.opacity=0.5"
               alt="search">
        </a>
      </h3>
    </div>
  </div>

  <div class="container content">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.9/styles/github.min.css"> 
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.9/highlight.min.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 수직형 디스플레이 광고1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-9951774327887666"
     data-ad-slot="7237421728"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<div class="post">
  <h1 class="post-title">파이썬 정규표현식(re) 사용법 - 05. 주석, 치환, 분리</h1>
  <span class="post-date">04 Aug 2018</span>
   |
  
  <a href="/blog/tags/#regex" class="post-tag">Regex</a>
  
  <a href="/blog/tags/#re" class="post-tag">re</a>
  
  
  <article>
    <p><strong>목차</strong></p>
    <ul>
  <li><a href="#정규표현식-중급-주석-추가">정규표현식 중급: 주석 추가</a></li>
  <li><a href="#정규표현식-중급-치환">정규표현식 중급: 치환</a>
    <ul>
      <li><a href="#resubpattern-repl-string-count-flags">re.sub(pattern, repl, string, count, flags)</a></li>
      <li><a href="#resubnpattern-repl-string-count-flags">re.subn(pattern, repl, string, count, flags)</a></li>
      <li><a href="#정규식-일치부를-문자열에서-제거">정규식 일치부를 문자열에서 제거</a></li>
      <li><a href="#치환-텍스트에-정규식-일치부-삽입">치환 텍스트에 정규식 일치부 삽입</a></li>
      <li><a href="#치환-텍스트에-정규식-부분-일치부-삽입">치환 텍스트에 정규식 부분 일치부 삽입</a>
        <ul>
          <li><a href="#명명-그룹을-사용한-경우">명명 그룹을 사용한 경우</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#정규표현식-중급-split">정규표현식 중급: split</a></li>
  <li><a href="#정규표현식-초급-recompile">정규표현식 초급: re.compile</a></li>
</ul>

    <hr />

<p><a href="https://greeksharifa.github.io/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/07/20/regex-usage-01-basic/">파이썬 정규표현식(re) 사용법 - 01. Basic</a><br />
<a href="https://greeksharifa.github.io/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/07/21/regex-usage-02-basic/">파이썬 정규표현식(re) 사용법 - 02. 문자, 경계, flags</a><br />
<a href="https://greeksharifa.github.io/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/07/22/regex-usage-03-basic/">파이썬 정규표현식(re) 사용법 - 03. OR, 반복</a><br />
<a href="https://greeksharifa.github.io/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/07/28/regex-usage-04-intermediate/">파이썬 정규표현식(re) 사용법 - 04. 그룹, 캡처</a><br />
<strong><a href="https://greeksharifa.github.io/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/08/04/regex-usage-05-intermediate/">파이썬 정규표현식(re) 사용법 - 05. 주석, 치환, 분리</a></strong><br />
<a href="https://greeksharifa.github.io/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/08/05/regex-usage-06-advanced/">파이썬 정규표현식(re) 사용법 - 06. 치환 함수, 양방탐색, 조건문</a><br />
<a href="https://greeksharifa.github.io/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/08/06/regex-usage-07-example/">파이썬 정규표현식(re) 사용법 - 07. 예제(숫자)</a><br />
<a href="https://greeksharifa.github.io/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/08/06/regex-usage-08-example/">파이썬 정규표현식(re) 사용법 - 08. 예제(단어, 행)</a><br />
<a href="https://greeksharifa.github.io/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/08/24/regex-usage-09-other-functions/">파이썬 정규표현식(re) 사용법 - 09. 기타 기능</a></p>

<hr />

<p>이 글에서는 정규표현식 중급 기술과 python library인 <code class="highlighter-rouge">re</code> 패키지 사용법에 대해서 설명한다.</p>

<p>본 글에서 정규표현식은 <code class="highlighter-rouge">regex</code>와 같이, 일반 문자열은 ‘regex’와 같이 표시하도록 한다.</p>

<p>파이썬 버전은 3.6을 기준으로 하나, 3.x 버전이면 (아마) 동일하게 쓸 수 있다.<br />
2.7 버전은 한글을 포함한 비 알파벳 문자 처리가 다르다.</p>

<hr />

<h2 id="정규표현식-중급-주석-추가">정규표현식 중급: 주석 추가</h2>

<p>복잡한 정규식은 써 놓고 나중에 보면 한 줄밖에 안 되는 주제에 다른 스파게비 코드만큼이나 읽기 힘들다. 위에 주석으로 한 줄 이 정규식의 의미를 써놓는 게 부족한 경우가 있을지도 모른다. 그래서 정규식 내부에 주석을 넣는 기능이 있다.</p>

<p>주석은 특별히 어려운 부분이 아니다. 단지 <a href="https://greeksharifa.github.io/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/07/21/regex-usage-02-basic/#%EB%A7%88%EC%B9%A8%ED%91%9C%EB%8A%94-%EA%B0%9C%ED%96%89-%EB%AC%B8%EC%9E%90%EC%99%80-%EC%9D%BC%EC%B9%98-%EC%98%B5%EC%85%98">옵션</a> 중 하나인 <code class="highlighter-rouge">re.VERBOSE</code> 옵션을 사용하기만 하면 된다. 약자는 <code class="highlighter-rouge">re.X</code>이다.</p>

<p>위 옵션을 추가하면 정규식 내의 공백들이 무시된다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">r'''
010-# 핸드폰 앞자리 
\d{4}-# 중간자리
\d{4}# 뒷자리'''</span><span class="p">,</span>
                <span class="s">'010-1234-5678'</span><span class="p">,</span>
                <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
</code></pre></div></div>
<p>결과</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>010-1234-5678
</code></pre></div></div>

<p>인라인으로 쓰기 위해서는 모드 변경자 <code class="highlighter-rouge">(?x)</code>를 쓰면 된다.</p>

<p>위의 예시처럼 <code class="highlighter-rouge">re.VERBOSE</code>를 쓸 때는 삼중따옴표를 쓰는 것이 가장 좋다.<br />
또 일반 공백 문자는 무시되기 때문에, 정규식 내에 공백문자를 넣고 싶으면 <code class="highlighter-rouge">\ </code>(공백문자를 이스케이프 처리)를 사용하거나 <code class="highlighter-rouge">[ ]</code>처럼 대괄호 내에 공백문자를 집어넣으면 된다.<br />
탭 문자는 <code class="highlighter-rouge">\t</code>로 동일하고, 개행 문자는 <code class="highlighter-rouge">\n</code>은 무시되기 때문에(예시에선 개행을 했음에도 문자열이 이를 무시하고 일치되었다) <code class="highlighter-rouge">'\\n'</code> 또는 r<code class="highlighter-rouge">'\n'</code>으로 하는 것이 라인피드와 일치된다.</p>

<hr />

<h2 id="정규표현식-중급-치환">정규표현식 중급: 치환</h2>

<p>사실 치환도 어려운 개념은 아니지만, 활용하는 방법은 꽤 많기 때문에 중급으로 분류하였다.</p>

<p>치환은 말 그대로 정규식에 일치하는 부분 문자열을 원하는 문자열로 치환하는 것이다.<br />
파이썬 문자열은 기본적으로 <code class="highlighter-rouge">replace</code> 메서드를 갖고 있기 때문에 일반적인 문자열은 그냥 치환이 가능하다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">origin_str</span> <span class="o">=</span> <span class="s">'Ryan keep a straight face.'</span>
<span class="n">edited_str</span> <span class="o">=</span> <span class="n">origin_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'keep'</span><span class="p">,</span> <span class="s">'kept'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">edited_str</span><span class="p">)</span>
</code></pre></div></div>
<p>결과</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Ryan kept a straight face.
</code></pre></div></div>

<p>그러나 이 <code class="highlighter-rouge">replace</code>는 정규식 패턴에 대응하는 문자열을 찾아주지는 못한다. 그래서 <strong>re.sub</strong> 메서드가 필요하다.</p>

<h3 id="resubpattern-repl-string-count-flags">re.sub(pattern, repl, string, count, flags)</h3>

<p><img src="\public\img\정규표현식(re)\2018-08-05-regex-usage-05-intermediate\01_sub.PNG" alt="01" /></p>

<p>간단한 사용법은 다음과 같다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'</span><span class="err">\</span><span class="s">d{4}'</span><span class="p">,</span> <span class="s">'XXXX'</span><span class="p">,</span> <span class="s">'010-1234-5678'</span><span class="p">))</span>
</code></pre></div></div>
<p>결과</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>010-XXXX-XXXX
</code></pre></div></div>

<p>인자만 보아도 대략 감이 올 것이다. pattern, string, flags는 우리가 지금까지 써 왔던 것들이다.</p>

<p>나머지 두 개도 어려운 부분은 아니다. <strong>re.sub</strong>은 패턴에 일치되는 문자열은 다른 문자열로 바꿔주는 것이므로, repl은 당연히 그 ‘다른 문자열’에 해당하는 부분이다.</p>

<p>count 인자는, 최대 몆 개까지 치환할 것인가를 지정한다. 만약 일치되는 문자열이 3인데 count=2로 지정되어 있으면 마지막 세 번째 문자열은 치환되지 않는다.<br />
물론 일치되는 문자열이 count보다 적으면 그냥 전부 다 치환된다.</p>

<script data-ad-client="ca-pub-9951774327887666" async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="s">'Gorio'</span><span class="p">,</span> <span class="n">repl</span><span class="o">=</span><span class="s">'Ryan'</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> \
             <span class="n">string</span><span class="o">=</span><span class="s">'Gorio, Gorio, Gorio keep a straight face.'</span><span class="p">))</span>
</code></pre></div></div>
<p>결과</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Ryan, Ryan, Gorio keep a straight face.
</code></pre></div></div>

<p>인자가 많으므로 이번엔 파이썬의 특징인 인자 명시적 지정을 사용해 보았다.</p>

<p>결과에서 이해되지 않는 부분은 딱히 없을 것이다.<br />
참고로 <strong>re.sub</strong>은 일치된 위치를 따로 반환해 주지 않는다.</p>

<h3 id="resubnpattern-repl-string-count-flags">re.subn(pattern, repl, string, count, flags)</h3>

<p><img src="\public\img\정규표현식(re)\2018-08-05-regex-usage-05-intermediate\02_subn.PNG" alt="02" /></p>

<p><strong>re.subn</strong>은 <strong>re.sub</strong>과 매우 유사하지만, 리턴하는 값이 치환된 문자열과 더불어 치환된 개수의 튜플이라는 것이 다른 점이다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">subn</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="s">'Gorio'</span><span class="p">,</span> <span class="n">repl</span><span class="o">=</span><span class="s">'Ryan'</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> \
              <span class="n">string</span><span class="o">=</span><span class="s">'Gorio, Gorio, Gorio keep a straight face.'</span><span class="p">))</span>
</code></pre></div></div>
<p>결과</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>('Ryan, Ryan, Gorio keep a straight face.', 2)
</code></pre></div></div>

<p>문자열이 두 개 치환되었으므로 2를 같이 리턴한다.</p>

<h3 id="정규식-일치부를-문자열에서-제거">정규식 일치부를 문자열에서 제거</h3>

<p>왜 파이썬에서는 제거 메서드를 따로 만들지 않았는지는 잘 모르지만, <strong>re.sub</strong>으로 간단히 구현 가능하다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'Tube'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">'Tube Ryan'</span><span class="p">))</span>
</code></pre></div></div>
<p>결과</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Ryan
</code></pre></div></div>

<p>문자열을 제거할 때 공백 문자 하나가 남는 것은 흔히 하는 실수이다. 결과를 보면 ‘Ryan’ 앞에 공백 문자가 하나 있는데, 이를 실제 상황에서 본다면 은근히 신경 쓰일 것이다. 제거할 문자열 앞이나 뒤에 공백 문자를 하나 넣어서 같이 제거하도록 하자.</p>

<h3 id="치환-텍스트에-정규식-일치부-삽입">치환 텍스트에 정규식 일치부 삽입</h3>

<p>이번에는 문자열 치환 시 그냥 literal text가 아닌 일치된 부분을 재사용하는 방법을 알아보겠다. <a href="https://greeksharifa.github.io/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/07/28/regex-usage-04-intermediate/#-%EC%88%AB%EC%9E%90-%EC%95%9E%EC%84%9C-%EC%9D%BC%EC%B9%98%EB%90%9C-%EB%AC%B8%EC%9E%90%EC%97%B4%EC%9D%84-%EB%8B%A4%EC%8B%9C-%EB%B9%84%EA%B5%90">재참조부</a>와 약간 비슷한 개념이다.</p>

<p>URL을 markdown link로 변환해 보겠다. Markdown link는</p>

<blockquote>
  <p><code class="highlighter-rouge">[이름](URL)</code></p>
</blockquote>

<p>이렇게 구성된다.</p>

<p>파이썬에서 전체 일치부를 치환 텍스트에 삽입하려면 <code class="highlighter-rouge">\g&lt;0&gt;</code>이라는 토큰을 사용해야 한다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'https?://</span><span class="err">\</span><span class="s">S+'</span><span class="p">,</span>
             <span class="s">'[링크](</span><span class="err">\</span><span class="s">g&lt;0&gt;)'</span><span class="p">,</span>
             <span class="s">'http://www.google.com and https://greeksharifa.github.io'</span><span class="p">))</span>
</code></pre></div></div>
<p>결과</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[링크](http://www.google.com) and [링크](https://greeksharifa.github.io)
</code></pre></div></div>

<h3 id="치환-텍스트에-정규식-부분-일치부-삽입">치환 텍스트에 정규식 부분 일치부 삽입</h3>

<p>여러분은 <a href="https://greeksharifa.github.io/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/07/28/regex-usage-04-intermediate/#-%EC%88%AB%EC%9E%90-%EC%95%9E%EC%84%9C-%EC%9D%BC%EC%B9%98%EB%90%9C-%EB%AC%B8%EC%9E%90%EC%97%B4%EC%9D%84-%EB%8B%A4%EC%8B%9C-%EB%B9%84%EA%B5%90">여기</a>에서 재참조부 일부를 사용하는 방법을 배웠다. 그러면 치환 텍스트에도 이처럼 일부분을 삽입하는 방법이 있을 것이다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'(</span><span class="err">\</span><span class="s">d{4})-(</span><span class="err">\</span><span class="s">d{2})-(</span><span class="err">\</span><span class="s">d{2})'</span><span class="p">,</span> 
             <span class="s">r'\1.\2.\3'</span><span class="p">,</span>
             <span class="s">'1900-01-01'</span><span class="p">))</span>
</code></pre></div></div>
<p>결과</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1900.01.01
</code></pre></div></div>

<p>yyyy-mm-dd 형식이 yyyy.mm.dd 형식으로 바뀌었다.<br />
<code class="highlighter-rouge">\1</code>과 같은 문법을 쓸 때에는 <strong>r prefix</strong>를 붙여야 한다는 것을 기억하고 있을 것이다.</p>

<p>만약 위와 같은 상황에서 <code class="highlighter-rouge">\4</code>를 사용한다면, 아무것도 캡처된 것이 없으므로 에러 메시지를 볼 수 있을 것이다.</p>

<h4 id="명명-그룹을-사용한-경우">명명 그룹을 사용한 경우</h4>

<p>조금 위에서 <code class="highlighter-rouge">\g&lt;0&gt;</code>을 사용했었다. 그러면 명명 그룹의 경우 <code class="highlighter-rouge">\g&lt;name&gt;</code>을 사용한다는 것을 눈치챌 수 있을 것이다. 
비 명명 그룹은 <code class="highlighter-rouge">\g&lt;1&gt;</code>, <code class="highlighter-rouge">\g&lt;2&gt;</code>, … 을 사용한다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'(?P&lt;year&gt;</span><span class="err">\</span><span class="s">d{4})-(?P&lt;month&gt;</span><span class="err">\</span><span class="s">d{2})-(?P&lt;day&gt;</span><span class="err">\</span><span class="s">d{2})'</span><span class="p">,</span>
             <span class="s">'</span><span class="err">\</span><span class="s">g&lt;year&gt;.</span><span class="err">\</span><span class="s">g&lt;month&gt;.</span><span class="err">\</span><span class="s">g&lt;day&gt;'</span><span class="p">,</span>
             <span class="s">'1900-01-01'</span><span class="p">))</span>
</code></pre></div></div>
<p>결과</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1900.01.01
</code></pre></div></div>

<p>물론 명명 그룹과 비 명명 그룹을 혼용하는 것은 여러 번 말했듯이 좋은 생각이 아니다.</p>

<hr />

<h2 id="정규표현식-중급-split">정규표현식 중급: split</h2>

<p><strong>re.sub</strong> 말고도 유용한 함수는 <strong>re.split</strong>이다. 이 메서드는 파이썬 문자열의 기본 메서드인 split과 매우 유사하나, 정규식을 처리할 수 있다.</p>

<p>이 역시 어려운 함수는 아니기 때문에, 예시 하나를 바로 보도록 하겠다.<br />
html 태그 내에서 태그를 제외한 부분으로 split하는 예제이다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'&lt;[^&lt;&gt;]*&gt;'</span><span class="p">,</span>
               <span class="s">'&lt;html&gt; Wow &lt;head&gt; header &lt;/head&gt; &lt;body&gt; Hey &lt;/body&gt; &lt;/html&gt;'</span><span class="p">))</span>
</code></pre></div></div>
<p>결과</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['', ' Wow ', ' header ', ' ', ' Hey ', ' ', '']
</code></pre></div></div>

<p>물론 이렇게만 하면 빈 문자열 등도 많이 나온다. 이는 정규식으로 따로 처리하거나, 다음과 같이 쓰면 된다.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'&lt;[^&lt;&gt;]*&gt;'</span><span class="p">,</span>
                  <span class="s">'&lt;html&gt; Wow &lt;head&gt; header &lt;/head&gt; &lt;body&gt; Hey &lt;/body&gt; &lt;/html&gt;'</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">result</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">!=</span> <span class="s">''</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></div>
<p>결과</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['Wow', 'header', 'Hey']
</code></pre></div></div>
<p>정규식이 깔끔하긴 하지만, 한 번에 모든 것을 처리하려고 하면 힘들 수 있다. 파이썬 기본 기능도 잘 활용하자.</p>

<hr />

<h2 id="정규표현식-초급-recompile">정규표현식 초급: re.compile</h2>

<p>여기서는 <strong>re.compile</strong> 메서드를 알아볼 것이다.</p>

<p>여러분은 지금까지 <code class="highlighter-rouge">import re</code>를 사용하여 <code class="highlighter-rouge">re</code>로부터 직접 메서드를 호출해왔다. <strong>re.match</strong>, <strong>re.sub</strong> 등이 그 예시이다.</p>

<p>이 방식은 한두번 쓰고 말기에는 괜찮지만, 같은 정규식 패턴을 반복문 내에서 반복적으로 사용해야 할 경우 성능상의 부담이 있다.<br />
이는 정규식은 컴파일이란 과정을 거치기 때문인데, <code class="highlighter-rouge">re</code> 모듈로부터 직접 갖다 쓰면 매번 컴파일이란 비싼 계산을 해야 하기 때문에 성능이 떨어진다.</p>

<p><strong>re.compile</strong>은 컴파일을 미리 해 두고 이를 저장할 수 있다. 예시를 보자.</p>

<p>여러분은 지금까지 이렇게 해 왔다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">r'\b\d+\b'</span><span class="p">,</span> <span class="s">'Ryan 1 Tube 2 345'</span><span class="p">))</span>
</code></pre></div></div>

<p>이를 한 번 정도 쓰는 것이 아닌, 반복문 내에서 여러 번 쓴다면 이렇게 쓰는 것이 좋다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'ryan.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f_in</span><span class="p">:</span>
    <span class="n">reObj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">r'\b\d+\b'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f_in</span><span class="p">:</span>
        <span class="n">matchObj</span> <span class="o">=</span> <span class="n">reObj</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">matchObj</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
</code></pre></div></div>

<p>미리 컴파일해 두면 성능상의 이점이 있다.</p>

<p>사용법이 조금 달라진 것이 눈에 띌 것이다.</p>

<p>여러분은 지금까지,</p>
<ol>
  <li><code class="highlighter-rouge">re</code> 모듈로부터 직접 match, search 등 메서드를 써 왔다.
    <ul>
      <li>인자는 기본적으로 1) 정규식 패턴과 2) 찾을 문자열이 있었다.</li>
    </ul>
  </li>
</ol>

<p>컴파일을 미리 하는 버전은,</p>
<ol>
  <li>re.compile 메서드로부터 reObj를 만든다.
    <ul>
      <li>인자는 기본적으로 1) 정규식 패턴 하나이다.</li>
    </ul>
  </li>
  <li>reObj.match 혹은 search 등으로 문자열을 찾는다.
    <ul>
      <li>인자는 정규식 패턴은 이미 저장되어 있으므로 search 메서드에는 1) 찾을 문자열 하나만 주면 된다.</li>
    </ul>
  </li>
</ol>

<p>reObj가 무슨 정규식 패턴을 가졌는지 보려면 다음을 수행해 보라.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'</span><span class="err">\</span><span class="s">d+'</span><span class="p">))</span>
</code></pre></div></div>
<p>결과</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>re.compile('\\d+')
</code></pre></div></div>

<p>’'를 구분하기 위해는 ‘' 도 <code class="highlighter-rouge">\</code>에 의해 이스케이프 처리되어야 하므로 ‘'가 두 개 있다는 점을 주의하라.</p>

<hr />

<p><a href="https://greeksharifa.github.io/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/08/05/regex-usage-06-advanced/">다음 글</a>에서는 정규표현식 고급 기술을 다루도록 하겠다.</p>

  </article>
  <script type="text/javascript" async
          src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  
  <script data-ad-client="ca-pub-9951774327887666" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

</div>

<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-9951774327887666">
</amp-auto-ads>

<script data-ad-client="ca-pub-9951774327887666" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9951774327887666"
     data-ad-slot="6606866336"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<script data-ad-client="ca-pub-9951774327887666" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
    <li>
      <h3>
        <a href="/github/2020/05/27/github-usage-09-overall/">
          GitHub 사용법 - 09. Overall
          <small>27 May 2020</small>
        </a>
      </h3>
    </li>
    
    <li>
      <h3>
        <a href="/generative/model/2020/05/25/VAE/">
          Variational AutoEncoder 설명
          <small>25 May 2020</small>
        </a>
      </h3>
    </li>
    
    <li>
      <h3>
        <a href="/machine_learning/2020/05/01/AFM/">
          추천 시스템의 기본 - 06. AFM 논문 리뷰 및 Tensorflow 구현
          <small>01 May 2020</small>
        </a>
      </h3>
    </li>
    
  </ul>
</div>

<div id="disqus_thread"></div>
<script>

  /**
   *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
   *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

  var disqus_config = function () {
    this.page.url = 'http://localhost:4000/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/08/04/regex-usage-05-intermediate/';
    this.page.identifier = 'http://localhost:4000/%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D(re)/2018/08/04/regex-usage-05-intermediate/';
    //this.page.url = 'https://greeksharifa.github.com/';  // Replace PAGE_URL with your page's canonical URL variable
    //this.page.identifier = 'greeksharifa'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
  };

  (function () { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://greeksharifa.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by
  Disqus.</a></noscript>

  </div>
</div>

<label for="sidebar-checkbox" class="sidebar-toggle"></label>

<script>
  (function (document) {
    let toggle = document.querySelector('.sidebar-toggle');
    let sidebar = document.querySelector('#sidebar');
    let checkbox = document.querySelector('#sidebar-checkbox');

    document.addEventListener('click', function (e) {
      let target = e.target;

      if (target === toggle) {
        checkbox.checked = !checkbox.checked;
        e.preventDefault();
      } else if (checkbox.checked && !sidebar.contains(target)) {
        /* click outside the sidebar when sidebar is open */
        checkbox.checked = false;
      }
    }, false);
  })(document);
</script>

<script>
  (function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function () {
      (i[r].q = i[r].q || []).push(arguments)
    };
    i[r].l = 1 * new Date();
    a = s.createElement(o);
    m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
  })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

  ga('create', 'UA-00000000-1', 'auto');
  ga('send', 'pageview');
</script>


<!-- Naver Analytics -->	
<script type="text/javascript" src="//wcs.naver.net/wcslog.js"></script>
<script type="text/javascript">
  if(!wcs_add) var wcs_add = {};
    wcs_add["wa"] = "18cbce78e94161";
  wcs_do();
</script>

</body>

<script id="dsq-count-scr" src="//greeksharifa-github-io.disqus.com/count.js" async></script>

</html>
